<style>
    .feed {
        position: relative;
        width: 270px;
        height: 125px;
        background-color: #004c72;
        border-radius: 10px;
        flex-wrap: nowrap;
        cursor: pointer;
    }
</style>

<div>
    <div id="drop_1" style="position: absolute; top: 190px; left: 610px; opacity: .5;">
        <div style="background-color: gray; width: 140px; height: 30px; box-shadow: 3px 3px 3px black;"></div>
    </div>
    <div id="drop_2" style="position: absolute;top: 240px;left: 610px;opacity: .5;">
        <div style="background-color: gray; width: 140px; height: 30px; box-shadow: 3px 3px 3px black;"></div>
    </div>
    <div id="drop_3" style="position: absolute;top: 280px;left: 610px;opacity: .5;">
        <div style="background-color: gray; width: 140px; height: 30px; box-shadow: 3px 3px 3px black;"></div>
    </div>
    <div id="drop_4" style="position: absolute;top: 320px;left: 610px;opacity: .5;">
        <div style="background-color: gray; width: 140px; height: 30px; box-shadow: 3px 3px 3px black;"></div>
    </div>
</div>

<div>
    <div id="drag_1" draggable="true"
        style="left: 380px;top: 380px;position: absolute;display: flex;justify-content: center;align-items: center;margin:auto;width: 140px;height: 30px;background-color: #fac900;">
        <p style="color: #004c72; font-weight: bolder;">HIV/Hepatite B</p>
    </div>

    <div id="drag_2" draggable="true"
        style="left: 230px;top: 380px;position: absolute;display: flex;justify-content: center;align-items: center;margin:auto;width: 140px;height: 30px;background-color: #fac900;">
        <p style="color: #004c72; font-weight: bolder;">Tuberculose</p>
    </div>
    <div id="drag_3" draggable="true"
        style="left: 80px;top: 380px;position: absolute;display: flex;justify-content: center;align-items: center;margin:auto;width: 140px;height: 30px;background-color: #fac900;">
        <p style="color: #004c72; font-weight: bolder;">Escabiose/sarna</p>
    </div>
    <div id="drag_4" draggable="true"
        style="left: 529px;top: 380px;position: absolute;display: flex;justify-content: center;align-items: center;margin:auto;width: 140px;height: 30px;background-color: #fac900;">
        <p style="color: #004c72; font-weight: bolder;">Covid-19</p>
    </div>
</div>

<div style="height: 72px; width: 100%; background-color: #004c72; ">
    <div style="background-color: white; width: 17px; height: 66px; margin-left: 19px; display: flex;" /><img
        style="height: 43.5px; width:180px; margin-top: 12.8px; margin-left: 68.45px;"
        src="recursos/imgs/SI_H1.png"><img style="height: 73.05px; width:108.45px; margin-left:170.85px;"
        src="recursos/imgs/SI_H2.png">
    <img style="height: 46.8px; width:56.75px;  position: absolute; right: 1px;" src="recursos/imgs/SI_H3.png">
</div>
<div style="margin-top: 30px; margin-left: 40px;">
    <p>Considerando as formas de transmissão do HIV que acabamos de estudar, vamos fazer uma revisão?</p>
    <p>Arraste corretamente os itens que estão no quadro a fim de completar todos os espaços vazios de transmissão e de
        não
        transmissão do HIV.</p>
</div>
<div
    style="border-width: 1px; border-style: solid; border-color: #004c72; background-color: white; margin-top: 20px; margin-left: 30px; width: 730px; height: 240px; border-radius: 10px;">
</div>

<div id="sub"
    style="cursor: pointer; position: absolute; margin-left: 320px; background-color: rgb(0, 76, 114); margin-top: -6px; width: 140px; height: 30px; text-align: center; display: none;">
    <p style="color: white; font-weight: bolder; text-align: center;">Submeter</p>
</div>

<div style="margin-top: -262px; margin-left: 50px; width: 700px; height: 270px; position: absolute; z-index: 100; cursor: pointer; display: none;"
    class="feed" id="feedCerto">
    <img style="height: 70px; margin-top: -48px; margin-left: 30px;margin-bottom: 15px;" src="recursos/imgs/SI_CE.png">
    <h1 style="margin-left: 50px; color: #fac900;">Resposta correta</h1>
    <p style="margin-left: 50px; width: 575px; color: white;">
        Você está de parabéns! Além de o HIV ser transmitido por prática de sexo desprotegido (sem uso de preservativo),
        outras
        formas de transmissão são compartilhamento de seringas, agulhas, lâminas de barbear e outros materiais que
        perfuram ou
        cortam a pele e transfusão de sangue contaminado, durante a gestação (transmissão vertical) e a amamentação.</p>
</div>
<div style="margin-top: -262px; margin-left: 50px; width: 700px; height: 270px; position: absolute; z-index: 100; cursor: pointer; display: none;"
    class="feed" id="feedErrado">
    <img style="height: 70px; margin-top: -48px; margin-left: 30px;margin-bottom: 15px;" src="recursos/imgs/SI_CE.png">
    <h1 style="margin-left: 50px; color: #fac900;">Resposta incorreta</h1>
    <p style="margin-left: 50px; width: 575px; color: white;">Essa foi por pouco! Além de o HIV ser transmitido por
        prática de sexo desprotegido (sem uso de preservativo), outras
        formas de transmissão são compartilhamento de seringas, agulhas, lâminas de barbear e outros materiais que
        perfuram ou
        cortam a pele e transfusão de sangue contaminado, durante a gestação (transmissão vertical) e a amamentação.
        Observe a
        sequência correta da atividade.</p>
<img style="height: 46.8px; width:56.75px;  position: absolute; right: 1px;" src="recursos/imgs/SI_39Errado.png">
</div>
</div>
<footer style="height: 39.05px; width: 100%; background-color: #004c72;">
    <img style="height: 22.65px; margin: 8.5px 37.05px;" src="recursos/imgs/SI_F1.png">
    <img style="height: 22.75px; margin: 8.5px 37.05px; position: absolute; right: 0px;" src="recursos/imgs/SI_F2.png">
</footer>

<script>
    $(() => {
        let sub = $("#sub").hide().on("click", validarReposta);
        const empties = $(document).find('[id^=drop]');
        let drag;
        let voltar = [];
        let positions = [];
        let janelas = $(document).find('[id^=feed]').css('cursor', 'pointer').on("click", apagarJanelas);
        apagarJanelas();

        function apagarJanelas() {
            janelas.map((index, janela) => {
                $(janela).hide();
            })
        }

        const dragStart = function () {
            this.className += " hold";
            drag = this;
            setTimeout(() => (this.className = "invisible"), 0);
            apagarJanelas();
        };

        const dragOver = function (e) {
            e.preventDefault();
        };

        const dragEnter = function (e) {
            e.preventDefault();
            this.className += " hovered";
        };

        const dragLeave = function () {
            this.className = "empty";
        };

        const dragEnd = function () {
            this.className = "drag";
        };

        const dragDrop = function () {
            this.className = "empty";
            if (this.id.indexOf('drop') == 0) {
                $(sub).fadeIn();
                $("#" + drag.id).animate({ top: $(this)[0].offsetTop, left: $(this)[0].offsetLeft }, 1);
                if (drag.id.split('_')[1] == this.id.split('_')[1]) {
                    //$(janelas[(this.id.split('_')[1] - 1)]).fadeIn();
                    voltar.map((objeto, index) => {
                        if (objeto == drag.id) {
                            voltar[index] = null;
                        }
                    })
                } else {
                    voltar[Number(drag.id.split('_')[1]) - 1] = drag.id;
                }
            }
        };

        function validarReposta() {
            if (voltar.every(elem => elem == null)) {
                $("#feedCerto").fadeIn();
            } else {
                voltar.map((objeto, index) => {
                    $("#" + objeto).animate(positions[index], 600);
                })
                $("#feedErrado").fadeIn();
            }
            voltar = [];
        }

        $(document).find('[id^=drag]').map((index, objeto) => {
            objeto.addEventListener("dragstart", dragStart);
            objeto.addEventListener("dragend", dragEnd);
            positions[index] = { top: objeto.offsetTop, left: objeto.offsetLeft }
        })

        for (const empty of empties) {
            empty.addEventListener("dragover", dragOver);
            empty.addEventListener("dragenter", dragEnter);
            empty.addEventListener("dragleave", dragLeave);
            empty.addEventListener("drop", dragDrop);
            voltar.push(null)
        }
    })
</script>